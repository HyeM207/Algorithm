# 구간 합
구간 합은 합 배열을 이용하여 시간 복잡도를 더 줄이기 위해 사용하는 특수한 목적의 알고리즘이다. 사용 빈도가 높으니 꼭 알아두자.  

구간 합 알고리즘을 활용하려면 먼저 `합 배열`을 구해야한다.

<br>

## 1차원 배열의 경우
리스트 A가 있을 때 `합 배열 S`는 다음과 같다.
> 합 배열 S 정의 

```python
# A[0]부터 A[i]까지의 합
S[i] = A[0] + A[1] + A[2] + ... + A[i-1] + a[i] 
```

합 배열은 기존의 리스트 데이터를 전처리한 배열로, 합 배열을 미리 구해 놓으면 시간 복잡도가 O(N)에서 O(1)로 감소한다.   

> 합 배열 S를 만드는 공식
```python
S[i] = S[i-1] + A[i]
```

> 구간 합을 구하는 공식
```python
S[j] - S[i-1] # i에서 j까지 구간 합
```
<br><br>

## 2차원 배열의 경우
2차원 배열이 주어진 경우, 1차원에서 2차원으로 합 배열을 확장해야한다.

> 합 배열 D 정의 

D[X][Y] = 원본 배열의 `(0, 0)`부터 `(X, Y)`까지의 **사각형 영역 안**에 있는 수의 합

> 합 배열 D 채우는 구간 합 공식
```
2차원 구간 합 배열의 1행, 1열은 다음 공식으로 채울 수 있다.
1열 : D[1][j] = D[1][j-1] + A[1][j]
1행 : D[i][1] = D[i-1][1] + A[i][1]

나머지 칸들은 아래 공식을 적용한다.
D[i][j] = D[i][j-1] + D[i-1][j] - D[i-1][j-1] + A[i][j]
```

> 질의 X1, Y1, X2, Y2에 대한 답을 구간 합으로 구하는 방법
```
D[X2][Y2] - D[X-1][Y2] - D[X2][Y1-1] + D[X1-1][Y1-1]
```
<br>
<details><summary>문제 예시</summary>

> Prefix Sum > [BOJ] 11660. 구간 합 구하기5

```
# 시도 3 - 230109 풀이 (성공)
import sys
input = sys.stdin.readline
n, m = map(int, input().split())

nList = [ [0] * (n+1) ]

# NxN 크기 표 값 입력 (한 칸씩 더 크게 만들기)
for _ in range(n):
    nList.append([0]+list(map(int, input().split())))


# 구간 합 배열 만들기 (한 칸씩 더 크게 만들기)
D = [[0] * (n+1) for _ in range(n+1)]


## 구간 합 배열 채우기
for i in range(1, n+1) :
    for j in range(1, n+1) :
        D[i][j] = D[i][j-1] + D[i-1][j] - D[i-1][j-1] + nList[i][j]
# print("구간 합 : " , D)

# 구간 입력 및 구간 합 계산 
for _ in range(m):
    x1, y1, x2, y2 = map(int, input().split()) 
    print(D[x2][y2] - D[x1-1][y2] - D[x2][y1-1] + D[x1-1][y1-1])


# 후기 : 부분 합 공식을 암기하자. 그리고 부분 합 배열 크기를 n만큼이 아닌 한 칸 늘린 n+1으로 하는 것이 더 나음
```

</details>